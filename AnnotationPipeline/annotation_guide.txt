
## CURRENT PIPELINE COMMANDS ##

Load for annotation:
python3 -m prodigy textcat.teach test2_flashback_dataset blank:sv NEW_DATA/shuffled_keyword_flashback_dataset.jsonl --label SEVERE_TOXIC --patterns Patterns/pattern_toxic-TOXIC.jsonl

Save dataset into file:
python3 -m prodigy db-out test_flashback_dataset  > Data/annotated_test_flashback_dataset.jsonl


Train a model on dataset:

python3 -m prodigy train test_flashback-model --textcat-multilabel test_flashback_dataset --base-model blank:sv --eval-split 0.2

python3 -m prodigy train flashback_random_keyword-model --textcat-multilabel flashback_random_keyword_dataset --base-model blank:sv --eval-split 0.2


###############################
## 1: Load data from Huggingface, parse and save in jsonl format ##

  - run the load_to_json.py script to save
  - saves data to .jsonl format

## 2: Active annotation ##

- textcat.teach = spacy classifier model
- blank:sv = pipeline for swedish

python3 -m prodigy RECIPE DATASET_NAME SPACY_PIPELINE INPUT_DATA --label LABEL --patterns PATTERN

python3 -m prodigy textcat.teach sexist_dataset blank:sv raw_oscar_50000.jsonl --label SEXIST --patterns pattern_sexist-SEXIST.jsonl
python3 -m prodigy textcat.teach sexist_dataset blank:sv Data/raw_oscar_10.jsonl --label SEXIST --patterns Patterns/pattern_sexist-SEXIST.jsonl
python3 -m prodigy textcat.teach racist_dataset blank:sv Data/samples_racism.jsonl --label RACIST --patterns Patterns/pattern_racist-RACIST.jsonl
python3 -m prodigy textcat.teach threat_dataset blank:sv Data/samples_threats.jsonl --label THREAT

python3 -m prodigy textcat.teach sexist_dataset blank:sv Data/raw_oscar_300-000.jsonl --label SEXIST --exclude sexist_dataset


## 3: Saving annotated data as jsonl file ##

python3 -m prodigy db-out DATASET_NAME  > OUTPUT_FILE

python3 -m prodigy db-out sexist_dataset  > Data/annotated_sexist_dataset.jsonl


## 4: Clean the jsonl file into more compact format/ remove unnecessary data added by Prodigy ##

- run the clean_annotated script 
- saves the data to a clean annotated .jsonl format


## Test training a model on our annotated data ##

python3 -m prodigy train MODEL_NAME --textcat-multilabel DATASET_NAME --eval-split DATA_SPLIT

python3 -m prodigy train sexist-model --textcat-multilabel sexist_dataset --base-model blank:sv --eval-split 0.2

## Plotting ## 
python3 -m prodigy train-curve sexist-model --textcat-multilabel sexist_dataset --base-model blank:sv --eval-split 0.2

python3 -m prodigy train-curve --textcat-multilabel sexist_dataset --show-plot
